name: "Release Drafter"
on:
  pull_request:
    types: [closed]
    branches:
      - production

jobs:
  release-drafter:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the pr
        uses: actions/checkout@v4

      - name: Create Release Draft
        run: |
          TAG="v1.0.0"
          TITLE="$TAG"
          BODY="Description of the release"
          curl -L \
            -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/${{ github.repository }}/releases \
            -d "{
              \"tag_name\": \"$TAG\",
              \"target_commitish\": \"production\",
              \"name\": \"$TITLE\",
              \"body\": \"$BODY\",
              \"draft\": true,
              \"prerelease\": false,
              \"generate_release_notes\": false
            }"